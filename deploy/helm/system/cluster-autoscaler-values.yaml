# Cluster Autoscaler Values
# Helm chart: autoscaler/cluster-autoscaler
# Docs: https://github.com/kubernetes/autoscaler/tree/master/charts/cluster-autoscaler

autoDiscovery:
  clusterName: dev-contentpulse-cluster
  tags:
    - k8s.io/cluster-autoscaler/enabled
    - k8s.io/cluster-autoscaler/dev-contentpulse-cluster

awsRegion: ap-south-1

rbac:
  create: true
  serviceAccount:
    create: true
    name: cluster-autoscaler
    annotations:
      # Role ARN set dynamically by Terraform Helm provider
      eks.amazonaws.com/role-arn: ""

# Resource configuration
resources:
  requests:
    cpu: 50m
    memory: 64Mi
  limits:
    cpu: 100m
    memory: 128Mi

# Replica count
replicaCount: 1

# Autoscaler settings
extraArgs:
  # Scale down settings (aggressive for dev to save costs)
  scale-down-enabled: true
  scale-down-delay-after-add: 5m
  scale-down-delay-after-delete: 0s
  scale-down-delay-after-failure: 3m
  scale-down-unneeded-time: 5m
  scale-down-utilization-threshold: 0.5
  # Skip system pods check for faster scaling
  skip-nodes-with-system-pods: false
  skip-nodes-with-local-storage: false
  # Balance similar node groups
  balance-similar-node-groups: true
  # Expander strategy
  expander: least-waste

# Pod labels
podLabels:
  app: cluster-autoscaler
